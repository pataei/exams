\chapter{Variational Database Use Cases}
\label{ch:vdbusecase}

\eric{pls read from here}
Thus far we introduced the variational database framework and variational
queries. However, the question becomes: ``How useable is the variational
database framework?'', ``How hard is it to generate a VDB and write 
variational queries?'', ``Can a VDB be generated automatically? And if so,
what is required to make this process automated?''. 
%
In this chapter, we aim at answering these questions.
Thus, the goal of this chapter is twofold: 
first, how generating a VDB can be made automatic;
second, to guid an expert through both generating a VDB
from a variation scenario when it cannot be done automatically and
writing variational queries that express expert's information need over
multiple database variants in the variation scenario.
%

%First, we focus on generating a VDB automatically. 
A VDB can be generated automatically when the main variational information and
database variants are available, that is, when the closed set of features, the
feature model, and closed set of database variants are provided.
%
Unfortunately, in practice, these information and encodings are not available 
since existing work only focuses on studying a specific 
kind of variation in databases and does not encode variation inside the database,
instead, it addresses the problem with tools that simulate the effect of the
specific kind of variation.
% following are given:
%(1) its closed feature set, (2) its feature model, and (3) its closed set of 
%database variants. \secref{genvdb} describes in detail how a VDB can 
%be generated by providing these inputs and shows the architecture of
%our module that implements automatic generation of VDBs. 
%\point{We describe how we systematically generated two 
%variational databases from real world scenarios where variation appears
%in databases.}\\
%- explain one comes from schema evlution and another from spl.
%Then, we switch gears to cases that a VDB cannot automatically be generated.
\eric{to here.}
Consequently, we describe how we systematically generated two 
variational databases from real world scenarios where variation appears
in databases. We take a scenario where variation over either time or space
exists in the database, use the schema variants to generate the variational schema, 
and attach feature expressions to tables and tuples to populate the VDB with
data for each use case. 

Additionally, variation in software affects not only databases but also how developers and
database administrators interact with databases.
%
Since different software variants have different information needs, developers
must often write and maintain different queries for different software
variants. Moreover, even if a particular information need is similar across
variants, different variants of a query may need to be created and maintained
to account for structural differences in the schema for each variant.
%
Creating and maintaining different queries for each variant is tedious and
error-prone, and potentially even intractable for large and open-ended
configuration spaces, such as most open-source projects~\cite{dbDecay16Stonebraker}.
%Thus, we illustrate how variational information needs can be captured by
%variational queries written in VRA.

%expressive query languages that account
%for variation explicitly and link variation in software and databases to
%queries by using the same feature names and configuration space.
%
Thus, for each use case we present a set of variational queries 
and we illustrate how VRA realizes the
information needs of the different variants of the database and potentially the 
corresponding software systems.
%
It achieves this level of expressiveness by accounting 
for variation explicitly and linking variation in software and databases to
queries by using the same feature names and configuration space.
%
We present only a  sample of the queries,
yet we provide the full query sets online.\footnote{Complete sets of queries in both formats are available at: \url{https://zenodo.org/record/4321921}.} 
%in the link provided in \secref{intro}.
%online and will be linked to throughout this
%section.
%
The full query sets capture all of the information needs described in the
papers that  we base our variation scenarios on. It is important to note that
this makes our query sets potentially biased toward queries containing more
variation points since the focus of the papers is on variational parts of the
system. A complete query set, capturing \emph{all}
information needs for each scenario might contain more plain queries, that is,
queries that perform the same way over all variants.
%
However, we do not believe this bias is harmful for the role the case studies
are intended to serve, namely, motivating and evaluating variational database
systems. For this role, queries that contain variation are more useful than
plain queries, and additional plain queries can likely be more easily generated
if needed.

We distribute the v-queries in two formats: (1) VRA,
% introduced in \secref{background}, 
encoded in the format used by
our VDBMS tool, and (2) plain SQL queries with embedded 
\cpp{ifdef}-annotations to capture variation points.
%
The SQL format provides queries for studying variational data 
independently of VDBMS tool and
will be more immediately useful for other researchers
studying variational data independently of our VDBMS tool, 
but we use VRA in
this thesis for its brevity
because it is much more concise.

\eric{also, pls read from here}
We first focus on variation in databases over space, 
\secref{enron-vdb}. \secref{enron-scenario} describes the
variation scenario from \citet{Hall05} that is the basis of this use case including the feature set and
feature model. Then, \secref{enron-vsch} and \secref{enron-pop} describe generating the variational schema for the described
variation scenario and populating the email SPL VDB with Enron email data,%
\footnote{\url{http://www.ahschulz.de/enron-email-data/}} respectively.
Finally, \secref{enron-qs} describes how variational queries capture the information need 
adapted from feature interactions described by \citet{Hall05}.
%
We then switch focus to variation in databases over time,
\secref{emp-vdb}. Again, \secref{emp-scenario} describes the
evolution of an employee database as the variation scenario from \citet{prima08Moon} 
that is the basis of this use case.
Then, \secref{emp-vsch} and \secref{emp-pop} describe generating the variational 
schema for the described
variation scenario and populating the employee VDB with a well-known employee data set,%
\footnote{\url{https://github.com/datacharmer/test_db}} respectively.
Finally, \secref{emp-qs} describes the adapted and adjusted queries from \citet{prima08Moon}. 
%
At the end of this chapter, \secref{usecase-disc}, we discuss the trade offs of using variational databases and
we answer the question: ``Should variation be encoded explicitly in databases?''.
\eric{to here.}

We distribute the VDBs, SQL scripts for generating them, and queries of our
use cases.\footnote{Available at: \url{https://zenodo.org/record/4321921}}
%in a GitHub repository.%
%\footnote{\url{https://github.com/lambda-land/VDBMS/tree/master/usecases}}
%
We distribute the VDBs in both MySQL and Postgres in two forms, one intended
for use with our VDBMS tool, and one intended for more general-purpose research
on variation in databases.
%
% with an embedded  schema representation described in \secref{enron-vsch}, and
% one without the embedded schema for use with our VDBMS tool, in which the
% variational schema is provided separately.
%
We distribute the variational queries as simple \cpp{ifdef}-annotated SQL files
to promote their broad reuse in the design and evaluation of other systems for
managing variational relational data.

%\input{sections/genvdb}

\input{sections/enronvdb}
\input{sections/enronqs}

\input{sections/empvdb}
\input{sections/empqs}

\input{sections/usecasedisc}