\begin{figure}
\begin{alignat*}{1}
\constrain . &: \qSet \totype \vSchSet \totype \qSet\\
%
\constrain \vRel &= 
%\chc [\getPCfrom {\vRel} \vSch] {\vPrj \vRel, \empRel}
\chc [\dimMeta] {\vPrj \vRel, \empRel}
\hspace{5pt} \textit{ where } \hspace{5pt}
\envWithoutVctx   {\vRel} {\annot \vAttList}
%\env [\getPC {\vSch}]  {\vRel} {\vAttList}
%\chc [\getPC {\vRel}] {\vRel, \empRel}  
\\
\constrain {\vSel \vQ}  &=  \vSel {\constrain \vQ}
\\
%
\constrain {\vPrj [\vAttList] \vQ} &= 
\vPrj [\vAttList \cap \VVal \vAttList] {\constrain \vQ}
\hspace{5pt} \textit{ where } \hspace{5pt}
\envWithoutVctx {{\constrain \vQ}} {\annot [\VVal \dimMeta] {\VVal \vAttList}}
%\env [\getPC {\vSch}]  {\vPrj [\vAttList] {\constrain \vQ}} {\VVal \vAttList}
\\
%
\constrain {{\vQ_1} \times {\vQ_2}} &= 
\constrain {\vQ_1} \times \constrain {\vQ_2}
\\
%
%\constrain {{\vQ_1} \Join_\vCond {\vQ_2}} &= 
%\constrain {\vQ_1} \Join_\vCond \constrain {\vQ_2}
%\\
%
\constrain {\chc {\vQ_1, \vQ_2}} &= 
\chc {\constrain [\pushIn {\annot [\dimMeta] \vSch}] {\vQ_1}, \constrain [\pushIn {\annot [\neg \dimMeta] \vSch}] {\vQ_2}}
\\
%
\constrain {{\vQ_1} \circ {\vQ_2}} &= 
\constrain {\vQ_1} \circ \constrain {\vQ_2}\\
%
\constrain {\empRel} &= \empRel
\end{alignat*}
\caption[Explicitly annotating a variational query with a variational schema]{
Explicitly annotating a well-typed query with a variational schema. 
%This function is a trivial recursion for the rest of VRA operations and 
%\ensuremath{\constrain {\empRel} = \empRel}.
%Queries passed to this 
%function are well-typed.
}
\label{fig:constrain}
\end{figure}
